<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bestSpot</title>
    <script type="text/javascript"
        src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=u9em6i295p&submodules=geocoder"></script>
    <sciprt src="/info_xlsx/지역별_아파트_정보.xlsx"></sciprt>
    <sciprt src="/info_xlsx/지역별_초등학교_정보.xlsx"></sciprt>
    <sciprt src="/info_xlsx/지역별_태권도_정보.xlsx"></sciprt>
    <script lang="javascript" src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
</head>

<body>
    <div id="map" style="width:100%; height:800px;"></div>

    <script>


        let map = new naver.maps.Map('map', {
            center: new naver.maps.LatLng(37.5112, 127.0981), // 잠실 롯데월드를 중심으로 하는 지도
            zoom: 15
        });

        let marker = new naver.maps.Marker({
            position: new naver.maps.LatLng(37.5112, 127.0981),
            map: map
        });

        naver.maps.Service.geocode({ address: '박달로 554' }, function (status, response) {
            if (status === naver.maps.Service.Status.ERROR) {
                return alert('Something wrong!');
            }
            let new_position = new naver.maps.LatLng(response.v2.addresses[0].y, response.v2.addresses[0].x)
            map.setCenter(new_position);

            let marker = new naver.maps.Marker({
                position: new naver.maps.LatLng(response.v2.addresses[0].y, response.v2.addresses[0].x),
                map: map
            });

            marker = new naver.maps.Marker({
                position: new naver.maps.LatLng(37.5112, 127.0981),
                map: map
            });
        });



        function fetchData() {

            //Here excell.xlsx file is in current working directory
            fetch('/info_xlsx/지역별_아파트_정보.xlsx').then(res => {
                return res.arrayBuffer();
            }).then(res => {
                var wb = XLSX.read(new Uint8Array(res), {
                    type: 'array'
                });
                wb.SheetNames.forEach(sheet => {
                    let rawObj = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheet]);
                    rawObj.map(obj => {

                        console.log(obj.사업장_유형, obj.사업장_이름, obj.사업장_주소);
                        //Here Name and Link is the column of the excel sheet
                        
                    });
                });
            })
        }
        
        fetchData()
    </script>
</body>

</html>